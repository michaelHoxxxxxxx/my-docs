# n8n 基础概念

n8n 是一个功能强大的 **可视化工作流自动化工具**，它允许用户通过 **低代码/无代码** 方式集成各种应用和服务，并自动执行任务。以下是 n8n 的几个核心概念：

---

## 1. 工作流（Workflow）

**工作流** 是 n8n 的核心，它定义了一系列自动化任务的执行步骤。一个工作流由多个 **节点（Nodes）** 组成，每个节点执行一个特定的任务，例如获取数据、处理数据或将数据发送到第三方服务。

示例：
- 一个 **自动备份** 工作流可以每天从数据库获取数据并上传到云存储。
- 一个 **邮件提醒** 工作流可以根据特定事件触发并发送通知邮件。

---

## 2. 节点（Nodes）

**节点** 是 n8n 中执行具体任务的单元，它们可以是：
- **触发器节点（Trigger Nodes）**：监听事件或定期执行，例如 `Cron` 定时触发器、`Webhook` 监听 HTTP 请求等。
- **常规节点（Regular Nodes）**：处理数据并执行操作，例如 `HTTP 请求`、`数据转换`、`数据库查询` 等。

示例：
- `Webhook` 节点可以接收来自外部应用的请求并触发工作流。
- `Google Sheets` 节点可以读取或写入 Google 表格数据。

---

## 3. 触发器（Trigger）

触发器是 **工作流的起点**，它决定了何时执行工作流。常见的触发器包括：
- **手动触发**：用户手动点击运行按钮执行工作流。
- **定时触发（Cron）**：按照设定的时间间隔自动运行。
- **事件触发**：如 Webhook 监听外部请求，或监听数据库数据变化。

示例：
- 每天早上 9 点自动运行一个数据同步工作流（Cron 触发）。
- 当用户提交表单时，Webhook 触发工作流并发送邮件。

---

## 4. 连接（Connections）

**连接** 指的是节点之间的关系，数据可以在节点之间传递。n8n 允许通过 **拖拽** 方式将多个节点连接在一起，形成完整的工作流。

连接的两种类型：
- **顺序执行**：节点按顺序执行，一个节点完成后下一个节点开始。
- **条件分支**：根据数据内容决定执行不同的节点，例如 `IF` 节点可以根据条件执行不同的操作。

示例：
- 处理订单的工作流可以先检查订单状态（`IF` 节点），如果是 **已付款**，则发货；如果是 **未付款**，则发送付款提醒。

---

## 5. 变量（Variables）

**变量** 在 n8n 中用于存储和传递数据，主要包括：
- **全局变量**（Workflow Variables）：工作流级别的数据存储，可以在多个节点之间共享。
- **环境变量**（ENV Variables）：在 n8n 配置文件或系统环境中定义的变量，用于存储 API Key 等敏感信息。

示例：
- 一个 `HTTP 请求` 节点获取 API 数据并将其存储到变量中，后续节点可以直接使用这个数据。

---

## 6. 表达式（Expressions）

n8n 支持使用 **表达式** 在节点之间传递数据，表达式以 `{{ }}` 语法编写，例如：
- `{{ $json["name"] }}` 代表获取当前节点 JSON 数据中的 `name` 字段。
- `{{ new Date().toISOString() }}` 获取当前时间并格式化为 ISO 格式。

表达式允许用户 **动态插入数据**，让工作流更加智能化和自动化。

---

## 7. 执行模式（Execution Modes）

n8n 提供多种 **执行模式** 来运行工作流：
- **手动模式（Manual Mode）**：用户在编辑器中手动运行工作流进行测试。
- **自动模式（Active Mode）**：n8n 服务器后台自动监听触发器，工作流在满足条件时自动执行。
- **队列模式（Queue Mode）**：适用于大规模任务，多个工作流可以并行执行，提高效率。

---

## 8. 版本管理（Versioning）

n8n 允许对工作流进行 **版本管理**，用户可以：
- **查看历史版本**：回溯工作流的修改记录。
- **恢复旧版本**：如果当前版本有问题，可以恢复到之前的工作流版本。

---

## 9. 运行日志（Execution Logs）

每次工作流执行后，n8n 会记录详细的 **执行日志**，包括：
- **执行时间**
- **执行状态**（成功/失败）
- **错误信息**（如果有）

日志可以帮助用户调试工作流，快速发现和解决问题。

---

## 10. n8n 扩展功能

n8n 具有强大的扩展能力：
- **自定义节点（Custom Nodes）**：开发人员可以使用 JavaScript/TypeScript 编写自定义节点，满足特定业务需求。
- **第三方集成（Integrations）**：n8n 支持上百种应用，包括 Slack、Google Sheets、MySQL、AWS、OpenAI 等。
- **API 访问**：n8n 提供 REST API，允许用户通过代码控制工作流的创建、修改和执行。

